\documentclass[a4paper, 10pt, ]{article}

\input{../../KUT000/preamble_v1.0.tex}

% -----------------------------------------------------------------------------

\def\oznacenieCelku{Kolekcia učebných textov}

% -----------------------------------------------------------------------------


\def\KUTporadoveCislo{019}

\def\oznacenieVerzie{v0.95}
% \def\oznacenieVerzie{\phantom{v1.0}}

\def\mesiacRok{jún 2025}

\def\authorslabel{MT}






% -----------------------------------------------------------------------------

\begin{document}

% -----------------------------------------------------------------------------
% Uvodny nadpis

\noindent
\parbox[t][18mm][c]{0.3\textwidth}{%
\raisebox{-0.9\height}{%
\phantom{.}\includegraphics[height=18mm]{../../KUT000/URKFEIlogo_v0.1.pdf}%
}%
}%
\parbox[t][18mm][c]{0.7\textwidth}{%
\raggedleft

\sffamily
\fontsize{16pt}{18pt}
\fontseries{sbc}
\selectfont

\noindent
\textcolor[rgb]{0.75, 0.75, 0.75}{\textls[25]{\oznacenieCelku}}
}%

\noindent
\parbox[t][16mm][b]{0.5\textwidth}{%
\raggedright

\color{Gray}
\sffamily

\fontsize{12pt}{12pt}
\selectfont
\mesiacRok

\fontsize{6pt}{10pt}
\selectfont
github.com/OkoliePracovnehoBodu/KUT

\fontsize{8pt}{10pt}
\selectfont
\authorslabel




}%
\parbox[t][16mm][b]{0.5\textwidth}{%
\raggedleft

\sffamily

\fontsize{6pt}{6pt}
\selectfont

\textcolor[rgb]{0.68, 0.68, 0.68}{\oznacenieVerzie}


\fontsize{14pt}{14pt}
\selectfont

\bfseries

\includegraphics[height=12pt]{../../KUT000/KUT_logo_v0.1.pdf}%
{%
\textls[-50]{\KUTporadoveCislo}
}%
}%

% -----------------------------------------------------------------------------




\vspace{6mm}

% ---------------------------------------------
\sffamily
\bfseries
\fontsize{18pt}{21pt}
\selectfont

\begin{flushleft}
    LMOT: Príklad spracovania datasetu pre prevodovú charakteristiku
\end{flushleft}

\bigskip

% -----------------------------------------------------------------------------
\normalsize
\normalfont
% -----------------------------------------------------------------------------

\lstset{style=mystyle}










\noindent
\lettrine[lines=1, nindent=1pt, loversize=0.0]{C}{ieľom} 
textu je uvedenie prikladu spracovania dát, z ktorých je možné získať prevodovú charakteristiku daného dynamického systému. Tento text priamo nadväzuje na \href{run:../../KUT018/TeX/KUT018.pdf}{\textsf{KUT018}}, kde je prezentovaný práve súbor takýchto dát.

 






\section{Získané dáta}

Príklad získaných dát z datasetu opísaného v dokumente \href{run:../../KUT018/TeX/KUT018.pdf}{\textsf{KUT018}} je znázornený na nasledujúcom obrázku \ref{fj_01_data_pot0}.  


% \begin{center}
    \begin{figure}[!b]

    \vbox{%
        \makebox[\textwidth][c]{%
        \includegraphics{fj_01_data_pot0_panel_1.pdf}
        }

        \makebox[\textwidth][c]{%
        \includegraphics{fj_01_data_pot0_panel_3.pdf}
        }

        \makebox[\textwidth][c]{%
        \includegraphics{fj_01_data_pot0_panel_2.pdf}
        }

        \figcaption{ 
        % \caption{
            Získané dáta pre vstupný signál a výstupný signál systému LMOT pri manuálne nastavenej prevádzkovej podmienke $0$ [V].
        }
        \label{fj_01_data_pot0}
    }%vbox

    \end{figure}
% \end{center}

Dátový súbor obsahuje informácie o ustálených stavoch systému vo zvolených ustálených hodnotách vstupu a prevádzkovej podmienky (manuálneho vstupu) ako je uvedené v tabuľke \ref{tab:ustalene_hodnoty_vstupneho_signalu} a~v~tabuľke \ref{tab:ustalene_hodnoty_podmienok}. Dáta na obrázku \ref{fj_01_data_pot0} teda poskytujú informácie o~ustálených stavoch systému pri prevádzkovej podmienke $0$ [V] a pre rozsah vstupného signálu od $0$ [V] do $10$ [V]. Všetky získané dáta pre ostatné prevádzkové podmienky sú uvedené takýmto spôsobom vizualizované v texte \href{run:../../KUT018/TeX/KUT018.pdf}{\textsf{KUT018}}.





% \begin{center}
\begin{table}[!h]

% \vspace{-10pt}    
    
\tabcaption{Ustálené hodnoty vstupného signálu [V]}
\label{tab:ustalene_hodnoty_vstupneho_signalu}

\vspace{-10pt}

\lstyle

\begin{tabular*}{\textwidth}{@{ \extracolsep{\fill}} ccccccccccc}
\toprule
0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\
\bottomrule
\end{tabular*}

\end{table}
% \end{center}




% \begin{center}
\begin{table}[!h]

% \vspace{-10pt}   

\tabcaption{Ustálené hodnoty signálu o prevádkových podmienkach [V]}
\label{tab:ustalene_hodnoty_podmienok}

\vspace{-10pt}

\lstyle

\begin{tabular*}{\textwidth}{@{ \extracolsep{\fill}} ccccccccccc}
\toprule
0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\
\bottomrule
\end{tabular*}

\end{table}
% \end{center}








\section{Spracovanie dát pre prevádzkovú podmienku 0 [V]}

\subsection{Vyznačenie ustálených úsekov}

Zo získaných dát na obrázku \ref{fj_01_data_pot0} je potrebné vyňať úseky, počas ktorých sú výstupný a~vstupný signál ustálené. V tomto prípade nech za ustálený stav sa považuje posledných 30 \% zvoleného časového intervalu pre ustálenie, teda posledných 36 sekúnd z celkových 120 sekúnd. Takto vyňaté úseky sú znázornené na obrázku \ref{fj_02_data_pot0}.


% \begin{center}
    \begin{figure}[!b]

    \vbox{%
        \makebox[\textwidth][c]{%
        \includegraphics{fj_02_data_pot0_panel_1.pdf}
        }

        \makebox[\textwidth][c]{%
        \includegraphics{fj_02_data_pot0_panel_3.pdf}
        }

        \vspace{-6pt}

        % \figcaption{ 
        \caption{
            % 
        }
        \label{fj_02_data_pot0}
    }%vbox

\end{figure}
% \end{center}









\subsection{Nameraná prevodová charakteristika}

Vyňaté úseky je možné zlúčiť do jedného dátového súboru. Obsahuje len hodnoty vstupného signálu a výstupného signálu, pre ktoré je možné konštatovať, že zodpovedajú ustálenému stavu. Takéto dáta charakterizujú systém v ustálených stavoch.

Grafické znázornenie uvedených dát tak, že na x-ovej osi sú hodnoty vstupného signálu v ustálenom stave a na y-ovej osi sú prislúchajúce hodnoty výstupného signálu v~ustálenom stave, je vlastne grafickým vyjadrením nameranej prevodovej charakteristiky. Nameraná prevodová charakteristika je znázornená na obrázku \ref{fj_03_data_pot0_panel_1}.

Pre lepšiu ilustráciu, že uvedený dataset neobsahuje takpovediac len niekoľko bodov, ale že každý ustálený stav je reprezentovaný viacerými hodnotami, je na obrázku \ref{fj_03_data_pot0_panel_2} zobrazený detail pre zvolenú hodnotu vstupného signálu.

% \begin{center}
    \begin{figure}[!t]

    \vbox{%
        \makebox[\textwidth][c]{%
        \includegraphics{fj_03_data_pot0_panel_1.pdf}
        }

        \vspace{-6pt}

        % \figcaption{ 
        \caption{
            Nameraná prevodová charakteristika pre prevádzkovú podmienku $0$ [V]. 
        }
        \label{fj_03_data_pot0_panel_1}
    }%vbox

\end{figure}
% \end{center}


% \begin{center}
    \begin{figure}[!t]

    \vbox{%
        \makebox[\textwidth][c]{%
        \includegraphics{fj_03_data_pot0_panel_2.pdf}
        }

        \vspace{-6pt}

        \figcaption{ 
        % \caption{
            % 
        }
        \label{fj_03_data_pot0_panel_2}

        \vspace{-6pt}

    }%vbox

\end{figure}
% \end{center}




\subsection{Aproximácia prevodovej charakteristiky}
\label{sec:Aproximácia prevodovej charakteristiky}


% \begin{center}
    \begin{figure}[!b]

    \vbox{%
        \makebox[\textwidth][c]{%
        \includegraphics{fj_04_data_pot0_panel_1.pdf}
        }

        \vspace{-6pt}

        \figcaption{ 
        % \caption{
            % 
        }
        \label{fj_04_data_pot0_panel_1}
    }%vbox

\end{figure}
% \end{center}


Nameraná prevodová charakteristika znázornená na obrázku \ref{fj_03_data_pot0_panel_1} zachytáva vzťah medzi vstupným a výstupným signálom v konkrétnych ustálených stavoch. Pre pokrytie celého rozsahu vstupného a výstupného signálu je účelné identifikovať model, ktorý by aproximoval nameranú prevodovú charakteristiku. 

Grafické znázornenie nameranej prevodovej charakteristiky na obrázku \ref{fj_03_data_pot0_panel_1}  ukazuje, že od hodnoty vstupného signálu $7$ [V] a viac je výstupná hodnota saturovaná na maxime (v podstate $10$ [V]). 

Vstupnú veličinu označme ako $u$ a výstupnú veličinu ako $y$. Závislosť výstupnej veličiny od vstupnej veličiny potom je 
\begin{equation}
    y = f(u)
\end{equation}
kde $f$ je funkcia, ktorá vyjadruje prevodovú charakteristiku systému.


Pre stanovenie modelu rozdeľme prevodovú charakteristiku na dve časti. Hľadáme funkciu $f_1$, ktorá bude aproximovať prevodovú charakteristiku pre hodnoty vstupného signálu $u$ v rozsahu $0 \leq u \leq 7$ [V] a funkciu $f_2$, ktorá bude aproximovať prevodovú charakteristiku pre hodnoty vstupného signálu $u$ v rozsahu $7 < u \leq 10$ [V].

Funkcia $f_2$ je v tomto prípade konštantná, pretože výstupný signál je saturovaný na hodnote $10$ [V]. Výstup modelu $\hat y$ na príslušnom rozsahu teda je
\begin{equation}
    \hat y = f_2(u) = 10 \quad \text{pre } 7 < u \leq 10
\end{equation}

Na úseku $0 \leq u \leq 7$ [V], na základe grafického zobrazenia nameranej prevodovej charakteristiky, je možné usúdiť, že hľadaná závislosť je blízka priamke. Preto nech funkcia $f_1$ je daná polynómom prvého stupňa, teda
\begin{equation}
    f_1(u) = \Theta_1 u + \Theta_0
\end{equation}
kde $\Theta_1$ a $\Theta_0$ sú parametre, ktoré je potrebné určiť.

Parametre je možné určiť metódou najmenších štvorcov, čo v tomto prípade znamená minimalizovať sumu štvorcov odchýlok medzi nameranými hodnotami výstupného signálu a hodnotami vypočítanými z modelu. Formálne je odchýlka $ e = y - \hat y$. Takúto polynomiálnu aproximáciu bežne implementujú knižnice pre numerické výpočty. V tomto prípade využijeme knižnicu \texttt{NumPy} a jej funkciu \texttt{polyfit}. Výsledkom je 
\begin{equation}
    f_1(u) = 1,399\ u - 0,1196
\end{equation}
a táto funkcia je znázornená na obrázku \ref{fj_04_data_pot0_panel_1}.



% \begin{center}
    \begin{figure}[!t]

    \vbox{%
        \makebox[\textwidth][c]{%
        \includegraphics{fj_04_data_pot0_panel_2.pdf}
        }

        \vspace{-6pt}

        \figcaption{ 
            %
        }
        \label{fj_04_data_pot0_panel_2}

        \vspace{-6pt}

    }%vbox

\end{figure}
% \end{center}

% \begin{center}
    \begin{figure}[!b]

    \vbox{%
        \makebox[\textwidth][c]{%
        \includegraphics{fj_05__panel_1.png}
        }

        \vspace{-6pt}

        % \figcaption{ 
        \caption{
            % 
        }
        \label{fj_05__panel_1}

        \vspace{-6pt}

    }%vbox

\end{figure}
% \end{center}

Ak by sme chceli model vyjadriť ako celok, formálne je možné písať
\begin{equation}
    \hat y = 
    \begin{cases}
        f_1(u) = 1,399\ u - 0,1196 & \text{pre } 0 \leq u \leq 7 \\
        f_2(u) = 10 & \text{pre } 7 < u \leq 10
    \end{cases}
\end{equation}
Graficky je výstup modelu znázornený na obrázku \ref{fj_04_data_pot0_panel_2}.












\section{Spracovanie dát pre všetky prevádzkové podmienky}

Obdobne ako na obr.~\ref{fj_03_data_pot0_panel_1} je možné vizualizovať všetky namerané prevodové charakteristiky pre všetky prevádzkové podmienky, pozri obrázok \ref{fj_05__panel_1}. 



Na tieto dáta, a teda na skúmaný systém ako celok, sa dá nazerať ako na dáta zodpovedajúce systému s~dvomi vstupmi a jedným výstupom. Prvým vstupom je dosiaľ uvádzaný vstupný signál, druhým vstupom je signál o prevádzkovej podmienke. Dáta reprezentujúce ustálené stavy je potom možné vizualizovať ako funkciu dvoch premenných, pozri obrázok \ref{fj_06__panel_1}.

% \begin{center}
    \begin{figure}[!t]

    \vspace{-10mm}

    \vbox{%
        \makebox[\textwidth][c]{%
        \includegraphics{fj_06__panel_1.png}
        }

        \vspace{-6pt}

        % \figcaption{ 
        \caption{
            % 
        }
        \label{fj_06__panel_1}

        \vspace{-6pt}

    }%vbox

\end{figure}
% \end{center}


\subsection{Aproximácia prevodovej charakteristiky pre každú prevádzkovú podmienku zvlášť}

V princípe je možné zrealizovať aproximáciu prevodovej charakteristiky podľa postupu uvedeného v~časti \ref{sec:Aproximácia prevodovej charakteristiky} pre každú prevádzkovú podmienku zvlášť. 






% \begin{center}
    \begin{figure}[!b]

    \vbox{%
        \makebox[\textwidth][c]{%
        \includegraphics{fj_04b_data_pot5_panel_2.pdf}
        }

        \vspace{-6pt}

        % \figcaption{ 
        \caption{
            Nameraná prevodová charakteristika pre prevádzkovú podmienku $5$ [V]. 
        }
        \label{fj_04b_data_pot5_panel_2}

        \vspace{-6pt}

    }%vbox

\end{figure}
% \end{center}

\paragraph{Zovšeobecňujúci príklad pri prevádzkovej podmienke 5 [V]}

Vo všeobecnosti je však potrebné zvážiť aj saturáciu výstupného signálu, ktorá sa prejavuje pri nízkych hodnotách vstupného signálu. Napríklad pre prevádzkovú podmienku $5$ [V] je nameraná prevodová charakteristika znázornená na obrázku \ref{fj_04b_data_pot5_panel_2}.

Nech hraničné hodnoty dolnej a hornej saturácie sú $1$ [V] a $9$ [V]. Potom model aproximujúci nameranú prevodovú charakteristiku pre je možné vyjadriť v tvare
\begin{equation}
    \hat y = 
    \begin{cases}
        f_1(u) = \Theta_1\ u - \Theta_0 & \text{pre } 1 \leq u \leq 9 \\
        f_2(u) = 10 & \text{pre } u > 9 \\
        f_3(u) = 0 & \text{pre } u < 1         
    \end{cases}
\end{equation}
pričom v tomto prípade sú parametre $\Theta_1 = 1,185$ a $\Theta_0 = -1,172$.







% \begin{center}
    \begin{figure}[!t]

    \vspace{-10mm}

    \vbox{%
        \makebox[\textwidth][c]{%
        \includegraphics{fj_06__panel_2.png}
        }

        \vspace{-12pt}

        % \figcaption{ 
        \caption{
            Červenou farbou sú znázornené tie hodnoty v ustálonom stave, pre ktoré platí, že výstupný signál má hodnotu vyššiu ako $9,9$ [V]. Modrou farbou tie, pre ktoré platí, že výstupný signál má hodnotu nižšiu ako $0,1$ [V]. Zelenou farbou ostatné.  
        }
        \label{fj_06__panel_2}
    }%vbox

\end{figure}
% \end{center}




% \begin{center}
    \begin{figure}[!b]

    \vspace{-2mm}

    \vbox{%
        \makebox[\textwidth][c]{%
        \includegraphics{fj_07__panel_1.png}
        }

        \vspace{-12pt}

        % \figcaption{ 
        \caption{
%  
        }
        \label{fj_07__panel_1}
    }%vbox

\end{figure}
% \end{center}









\subsection{Aproximácia s využitím viacfaktorového modelu}

Viac faktorovým modelom rozumieme taký, ktorý ma viac ako jeden vstup. V tomto prípade môžeme signál o polohe potenciometra využiť ako ďalší vstup do modelu. 


Na obrázku \ref{fj_06__panel_2} sú hodnoty v ustálenom stave znázornené ako funkcia dvoch premenných. Funkčnou hodnotou je výstupný signál a argumentmi sú vstupný signál a~prevádzková podmienka. Farebne sú odlíšené prípady, keď výstupný signál je saturovaný a keď nie je. Ak si odmyslíme saturované oblasti, potom môžeme usúdiť, že hodnoty v ustálenom stave tvoria rovinu v trojrozmernom priestore.

Modelom nesaturovanej oblasti nech je funkčná závislosť v tvare
\begin{equation}
    \hat y = f_4(u_1, u_2) = \Theta_{11}\ u_1 + \Theta_{12}\ u_2 + \Theta_0
\end{equation}
kde $u_1$ je vstupný signál, $u_2$ je prevádzková podmienka a $\Theta_{11}$, $\Theta_{12}$ a $\Theta_0$ sú parametre, ktoré je potrebné určiť.

Pre tento prípad boli v zmysle metódy najmenších štvorcov nájdené hodnoty parametrov $\Theta_{11} = 1,167 $, $\Theta_{12} = -0,37876$ a $\Theta_0 = 0,81$. Grafické porovnanie takéhoto modelu s nameranými hodnotami v nesaturovanej oblasti je znázornené na obrázku \ref{fj_07__panel_1}.












































% -----------------------------------------------------------------------------

\end{document}

% -----------------------------------------------------------------------------